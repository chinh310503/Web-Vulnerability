# Access control vulnerabilities

## Kiểm soát truy cập là gì

Kiểm soát truy cập là việc áp dụng các ràng buộc đối với người hoặc cái gì được phép thực hiện hành động hoặc truy cập tài nguyên. Trong bối cảnh của các ứng dụng web, kiểm soát truy cập phụ thuộc vào xác thực và quản lý phiên:

- Xác thực xác nhận rằng người dùng chính là người họ nói.
- Quản lý phiên xác định những yêu cầu HTTP tiếp theo nào đang được thực hiện bởi cùng một người dùng.
- Kiểm soát truy cập xác định xem người dùng có được phép thực hiện hành động mà họ đang cố gắng thực hiện hay không.
  
Kiểm soát truy cập bị hỏng là phổ biến và thường gây ra lỗ hổng bảo mật nghiêm trọng. Thiết kế và quản lý các biện pháp kiểm soát truy cập là một vấn đề phức tạp và năng động, áp dụng các ràng buộc về kinh doanh, tổ chức và pháp lý vào việc triển khai kỹ thuật. Các quyết định thiết kế kiểm soát truy cập phải do con người đưa ra nên khả năng xảy ra sai sót là rất cao.

**Kiểm soát truy cập dọc**

- Kiểm soát truy cập theo chiều dọc là các cơ chế hạn chế quyền truy cập vào chức năng nhạy cảm đối với những loại người dùng cụ thể.

- Với các biện pháp kiểm soát truy cập theo chiều dọc, các loại người dùng khác nhau có quyền truy cập vào các chức năng ứng dụng khác nhau. Ví dụ: quản trị viên có thể sửa đổi hoặc xóa bất kỳ tài khoản nào của người dùng, trong khi người dùng thông thường không có quyền truy cập vào các hành động này. Kiểm soát truy cập theo chiều dọc có thể là cách triển khai chi tiết hơn các mô hình bảo mật được thiết kế để thực thi các chính sách kinh doanh như phân chia nhiệm vụ và đặc quyền tối thiểu.

**Kiểm soát truy cập ngang**

- Kiểm soát truy cập theo chiều ngang là các cơ chế hạn chế quyền truy cập vào tài nguyên đối với những người dùng cụ thể.

- Với các điều khiển truy cập theo chiều ngang, những người dùng khác nhau có quyền truy cập vào một tập hợp con các tài nguyên cùng loại. Ví dụ: một ứng dụng ngân hàng sẽ cho phép người dùng xem các giao dịch và thực hiện thanh toán từ tài khoản của chính họ chứ không phải tài khoản của bất kỳ người dùng nào khác.

**Kiểm soát truy cập phụ thuộc vào ngữ cảnh**

- Kiểm soát truy cập phụ thuộc vào ngữ cảnh hạn chế quyền truy cập vào chức năng và tài nguyên dựa trên trạng thái của ứng dụng hoặc sự tương tác của người dùng với nó.

- Kiểm soát truy cập theo ngữ cảnh ngăn người dùng thực hiện hành động theo thứ tự sai. Ví dụ, một trang web bán lẻ có thể ngăn người dùng sửa đổi nội dung giỏ hàng của họ sau khi họ đã thanh toán.

## Ví dụ về kiểm soát truy cập bị hỏng

**Leo thang đặc quyền theo chiều dọc**

- Các chức năng không được bảo vệ
- Kiểm soát truy cập dựa trên tham số
- Kiểm soát truy cập bị hỏng do cấu hình sai nền tảng
- Kiểm soát quyền truy cập bị hỏng do sự khác biệt về kết quả khớp URL

**Leo thang đặc quyền theo chiều ngang**

**Leo thang đặc quyền theo chiều ngang sang chiều dọc**

**Tham chiếu đối tượng trực tiếp không an toàn**

**Lỗ hổng kiểm soát truy cập trong quy trình nhiều bước**

**Kiểm soát truy cập dựa trên vị trí**

**Kiểm soát truy cập dựa trên giá trị Referer của tiêu đề HTTP**

## Cách ngăn chặn lỗ hổng kiểm soát truy cập

Các lỗ hổng kiểm soát truy cập có thể được ngăn chặn bằng cách áp dụng phương pháp phòng thủ chuyên sâu và áp dụng các nguyên tắc sau:

- Không bao giờ chỉ dựa vào tính năng che giấu để kiểm soát quyền truy cập.
- Trừ khi một tài nguyên được thiết kế để có thể truy cập công khai, theo mặc định, hãy từ chối quyền truy cập.
- Bất cứ khi nào có thể, hãy sử dụng một cơ chế toàn ứng dụng duy nhất để thực thi các biện pháp kiểm soát truy cập.
- Ở cấp độ mã, bắt buộc nhà phát triển phải khai báo quyền truy cập được phép cho từng tài nguyên và từ chối quyền truy cập theo mặc định.
- Kiểm tra kỹ lưỡng và kiểm tra các biện pháp kiểm soát quyền truy cập để đảm bảo chúng hoạt động như thiết kế.
